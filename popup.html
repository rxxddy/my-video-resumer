<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Local Media Resumer</title>
    <style>
        /* --- Basic Structure --- */
        * { box-sizing: border-box; user-select: none; }
        body {
            width: 380px; height: 520px; margin: 0; padding: 0;
            font-family: 'Inter', 'Segoe UI', sans-serif;
            background-color: #1e1e24; color: #eceff4;
            display: flex; flex-direction: column; overflow: hidden; position: relative;
        }

        /* --- Header --- */
        header {
            background: linear-gradient(135deg, #ff6f00, #ff8f00);
            padding: 16px 24px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 10;
            display: flex; align-items: center; justify-content: space-between;
        }
        .header-title { display: flex; align-items: center; gap: 10px; }
        h3 { margin: 0; font-size: 18px; font-weight: 700; color: #fff; letter-spacing: 0.5px; }
        .header-btn {
            background: rgba(255,255,255,0.2); border: none; cursor: pointer; border-radius: 6px;
            width: 32px; height: 32px; display: flex; align-items: center; justify-content: center;
            transition: background 0.2s; color: white; margin-left: 8px;
        }
        .header-btn:hover { background: rgba(255,255,255,0.4); }
        .header-btn svg { width: 18px; height: 18px; fill: currentColor; }

        /* --- Settings Panel --- */
        #settings-panel {
            background-color: #2d2d35; padding: 15px 24px; border-bottom: 1px solid #3d3d45;
            display: none; flex-direction: column; gap: 12px; animation: slideDown 0.2s ease-out;
        }
        @keyframes slideDown { from { transform: translateY(-10px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .setting-row { display: flex; justify-content: space-between; align-items: center; font-size: 14px; color: #ddd; }
        .switch { position: relative; display: inline-block; width: 40px; height: 22px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #555; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #ff6f00; }
        input:checked + .slider:before { transform: translateX(18px); }

        /* --- Video List --- */
        #video-list { flex-grow: 1; overflow-y: auto; padding: 20px; }
        #video-list::-webkit-scrollbar { width: 6px; }
        #video-list::-webkit-scrollbar-track { background: #252525; }
        #video-list::-webkit-scrollbar-thumb { background-color: #555; border-radius: 3px; }

        .video-item {
            background-color: #2d2d35; border-radius: 12px; padding: 14px; margin-bottom: 14px;
            display: flex; align-items: center; justify-content: space-between;
            border: 1px solid #3d3d45; border-left: 5px solid #ff6f00;
            transition: transform 0.2s;
        }
        .video-item:hover { transform: translateY(-3px); box-shadow: 0 6px 16px rgba(0,0,0,0.4); background-color: #33333d; }
        .info-container { flex-grow: 1; overflow: hidden; margin-right: 16px; }
        .video-title { display: block; font-size: 14px; font-weight: 600; color: #fff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-bottom: 6px; }
        .video-progress { font-size: 12px; color: #ffb74d; font-family: 'Roboto Mono', monospace; display: flex; align-items: center; gap: 6px; }
        .actions { display: flex; gap: 10px; }
        button.action-btn {
            border: none; cursor: pointer; border-radius: 8px; width: 36px; height: 36px;
            display: flex; align-items: center; justify-content: center; background-color: #3d3d45;
        }
        .btn-icon { width: 16px; height: 16px; fill: #aaa; }
        .btn-play:hover { background-color: #ff6f00; } .btn-play:hover .btn-icon { fill: #fff; }
        .btn-delete:hover { background-color: #4d1f1f; } .btn-delete:hover .btn-icon { fill: #ff5252; }
        p { text-align: center; color: #777; font-size: 14px; margin-top: 40px; }

        /* --- CUSTOM MODAL --- */
        .modal-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.7); backdrop-filter: blur(4px);
            z-index: 100; display: none; align-items: center; justify-content: center;
            animation: fadeIn 0.2s ease-out;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .modal-content {
            background: #2d2d35; border: 1px solid #3d3d45; border-radius: 16px;
            padding: 24px; width: 80%; text-align: center; box-shadow: 0 10px 40px rgba(0,0,0,0.6);
            transform: scale(0.95); animation: popIn 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }
        @keyframes popIn { to { transform: scale(1); } }

        .modal-title { font-size: 16px; font-weight: 700; margin-bottom: 10px; color: #fff; }
        .modal-text { font-size: 13px; color: #aaa; margin-bottom: 20px; line-height: 1.5; }
        .modal-buttons { display: flex; gap: 12px; justify-content: center; }
        
        .btn-modal {
            padding: 10px 20px; border-radius: 8px; font-size: 13px; font-weight: 600; border: none; cursor: pointer;
            transition: opacity 0.2s;
        }
        .btn-cancel { background: #3d3d45; color: #fff; }
        .btn-confirm { background: #4d1f1f; color: #ff5252; }
        .btn-modal:hover { opacity: 0.9; }

    </style>
</head>
<body>
    <header>
        <div class="header-title">
            <img src="icon128.png" alt="" style="width:24px;height:24px;">
            <h3>My Resumer</h3>
        </div>
        <div style="display:flex;">
            <button id="toggle-settings" class="header-btn" title="Settings">
                <svg viewBox="0 0 24 24"><path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/></svg>
            </button>
            <button id="clear-all" class="header-btn" title="Clear All History">
                <svg viewBox="0 0 24 24"><path d="M15,4V3H9v1H4v2h1v13c0,1.1,0.9,2,2,2h10c1.1,0,2-0.9,2-2V6h1V4H15z M17,19H7V6h10V19z M9,8h2v9H9V8z M13,8h2v9h-2V8z"/></svg>
            </button>
        </div>
    </header>

    <div id="settings-panel">
        <div class="setting-row"><span>Show Rewind Buttons</span><label class="switch"><input type="checkbox" id="setting-rewind" checked><span class="slider"></span></label></div>
        <div class="setting-row"><span>Show Speed Control</span><label class="switch"><input type="checkbox" id="setting-speed" checked><span class="slider"></span></label></div>
        <div class="setting-row"><span>Show Incognito Button</span><label class="switch"><input type="checkbox" id="setting-incognito" checked><span class="slider"></span></label></div>
    </div>
    
    <div id="video-list"><p id="loading-message">Loading video history...</p></div>

    <div id="confirm-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-title">Delete All History?</div>
            <div class="modal-text">This will remove all saved progress for local videos and PDFs. This action cannot be undone.</div>
            <div class="modal-buttons">
                <button class="btn-modal btn-cancel" id="modal-cancel">Cancel</button>
                <button class="btn-modal btn-confirm" id="modal-confirm">Delete</button>
            </div>
        </div>
    </div>

    <svg style="display: none;">
        <symbol id="icon-resume" viewBox="0 0 512 512"><path d="M128 96v320l256-160L128 96z"/></symbol>
        <symbol id="icon-trash" viewBox="0 0 448 512"><path d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"/></symbol>
    </svg>
    <script src="popup.js"></script>
</body>
</html>